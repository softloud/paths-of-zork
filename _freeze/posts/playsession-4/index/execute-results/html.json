{
  "hash": "96ba005bae83f315dd209976c1d40219",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Define some functions\"  \nsubtitle: \"Playsesssion 4\"\nauthor: \"Charles T. Gray\"\ndate: \"2024-11-10\"\nexecute: \n  error: true\n  message: false\n  freeze: auto\ncategories: \n  - zork\n  - R\n---\n\n\n> Playsession highlight: still haven't cracked the operators or there is no way to combine the lunch with the nasty knife.\n\n```\n>open sack          \nOpening the brown sack reveals:\n  A clove of garlic.\n  A lunch.\n>hide knife in lunch\nI don't understand that.\n>look at lunch\nI see nothing special about the lunch.\n>put knife in bottle\nI can't reach inside.\n>use knife on lunch\nI don't understand that.\n>use knife with lunch\nI don't understand that.\n>combine knife and lunch\nI don't understand that.\n\n```\n\nHave repeated enough to want some helper functions now. Will draft them in this post, but I suppose next play session I suppose I'll need to be packaging it. \n\n\n## get data function\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nget_nodes_and_edges_raw <- function() {\n\n  googlesheets4::gs4_deauth()\n\n  gs_url <- \"https://docs.google.com/spreadsheets/d/10PSDN97MdqDH_QaofhVh5Te8n4MxpYf6XJM3JsGetxI/edit?gid=1960240112#gid=1960240112\"\n  \n  message('\\n*** zork nodes ***\\n')\n  zork_nodes <- googlesheets4::read_sheet(gs_url, 'nodes')\n  print(head(zork_nodes, 3))\n\n  message('\\n*** zork edges ***\\n')\n  zork_edges <- googlesheets4::read_sheet(gs_url, 'edges')\n  print(head(zork_edges, 3))\n\n  return(\n    list(\n      zork_nodes = zork_nodes,\n      zork_edges = zork_edges\n    )\n  )\n} \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# print() doesn't respect newline even with escape, but message handles newline\n# Also learnt, use message() for the text, but use print() for structured data \nzork_nodes_and_edges <- get_nodes_and_edges_raw()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\n*** zork nodes ***\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n✔ Reading from \"zork-graph-data\".\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n✔ Range ''nodes''.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 4\n  perspective_location region interactivity   loot   \n  <chr>                <chr>  <chr>           <chr>  \n1 west of house        forest solved: mailbox leaflet\n2 north of house       forest none            none   \n3 forest               forest song bird?      none   \n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\n*** zork edges ***\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n✔ Reading from \"zork-graph-data\".\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n✔ Range ''edges''.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 4\n  perspective_location perspective_to_target target_location discovered         \n  <chr>                <chr>                 <chr>           <dttm>             \n1 west of house        north                 north of house  2024-10-30 00:00:00\n2 north of house       east                  behind house    2024-10-30 00:00:00\n3 behind house         west                  kitchen         2024-10-30 00:00:00\n```\n\n\n:::\n:::\n\n\n## zork graph function\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncreate_zork_graph <- function(zork_nodes_and_edges, selected_region = 'all') {\n  zork_nodes <- zork_nodes_and_edges$zork_nodes\n  zork_edges <- zork_nodes_and_edges$zork_edges\n\n   if (selected_region != 'all') {\n    zork_nodes <- \n      zork_nodes |>  \n        dplyr::filter(region %in% c(selected_region, 'unexplored'))\n  }\n\n  zork_base_graph <- \n    zork_edges |> \n      dplyr::mutate(\n        from = perspective_location,\n        to = target_location\n      ) |>\n      # does order matter?\n      dplyr::select(from, to, everything()) |>\n      tidygraph::as_tbl_graph()\n  # Join the nodes data frame to the nodes of the graph\n  zork_graph <- zork_base_graph |>\n    tidygraph::activate(nodes) |>\n    # add attributes to nodes\n    dplyr::inner_join(zork_nodes, by = c(\"name\" = \"perspective_location\"))\n\n  print(zork_graph)\n\n  # report regions discovered\n  message('\\n*** zork regions discovered (zork_ggraph selected_region) ***\\n')\n  print(\n    zork_nodes |>\n      dplyr::filter(!(region %in% c('unexplored', 'inaccessible'))) |>\n      dplyr::pull(region) |>\n      unique()\n\n  )\n  message('\\n***\\n')\n\n  return(zork_graph)\n\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nzork_graph <- create_zork_graph(zork_nodes_and_edges)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tbl_graph: 18 nodes and 51 edges\n#\n# A directed multigraph with 1 component\n#\n# Node Data: 18 × 4 (active)\n   name                  region     interactivity            loot               \n   <chr>                 <chr>      <chr>                    <chr>              \n 1 west of house         forest     solved: mailbox          leaflet            \n 2 north of house        forest     none                     none               \n 3 behind house          forest     window to house          none               \n 4 kitchen               house      sack                     water, lunch, garl…\n 5 living room           house      rug, locked door to west sword, lantern     \n 6 cellar                cellar     none                     none               \n 7 west of chasm         cellar     unknown                  unknown            \n 8 gallery               cellar     painting                 none               \n 9 studio                cellar     note, 69 colours         none               \n10 north south crawlway  cellar     hole above, no climbing  unknown            \n11 the troll room        cellar     troll                    none               \n12 maze                  cellar     unknown                  unknown            \n13 east west passageway  cellar     unknown                  unknown            \n14 ravine crossing       cellar     none                     none               \n15 circular 8 directions cellar     compass needle spins     none               \n16 attic                 house      none                     rope, knife, clay  \n17 inaccessible          unexplored none                     none               \n18 unexplored            unexplored unknown                  unknown            \n#\n# Edge Data: 51 × 6\n   from    to perspective_location perspective_to_target target_location\n  <int> <int> <chr>                <chr>                 <chr>          \n1     1     2 west of house        north                 north of house \n2     2     3 north of house       east                  behind house   \n3     3     4 behind house         west                  kitchen        \n# ℹ 48 more rows\n# ℹ 1 more variable: discovered <dttm>\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\n*** zork regions discovered (zork_ggraph selected_region) ***\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"forest\" \"house\"  \"cellar\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\n***\n```\n\n\n:::\n:::\n\n\n\n## zork ggraph\n\n\n::: {.cell}\n\n```{.r .cell-code}\nzork_ggraph <- function(zork_nodes_and_edges, region = 'all') {\n  zork_graph <- create_zork_graph(zork_nodes_and_edges, region)\n\n  cols_f <- colorRampPalette(RColorBrewer::brewer.pal(8, 'Dark2'))\n\n  n_regions <- zork_nodes_and_edges$zork_nodes |> \n    dplyr::pull(region) |>\n    unique() |>\n    length()\n\n  zork_graph |> \n    ggraph::ggraph() +\n    ggraph::geom_edge_fan(\n      ggplot2::aes(label = perspective_to_target), \n      label_dodge = ggplot2::unit(2.5, 'mm'),\n      alpha = 0.8,\n      colour = 'grey',\n      label_size = 6,\n      label_colour = 'darkgrey',\n      family = 'Courier',\n      arrow = ggplot2::arrow(length = ggplot2::unit(2, 'mm')), \n      end_cap = ggraph::circle(1, 'cm')\n    ) +\n    ggraph::geom_node_text(\n      ggplot2::aes(\n        label = name,\n        colour = region\n      ),\n      repel = TRUE,\n      size = 8,\n      family = 'Courier'\n    ) +\n\n    # theming\n    ggraph::scale_edge_colour_manual(values = cols_f(n_regions)) + \n    ggplot2::scale_colour_manual(values = cols_f(n_regions)) +\n    ggplot2::theme_minimal(\n      base_family = 'Courier',\n      base_size = 20\n    ) +\n    ggplot2::theme(\n      axis.ticks = ggplot2::element_blank(),\n      axis.text = ggplot2::element_blank(),\n      panel.grid = ggplot2::element_blank() #,\n      # plot.margin = margin(30, 30, 30, 30)  # Adjust plot margins\n  ) +\n      ggplot2::scale_x_continuous(expand = ggplot2::expansion(mult = 0.2)) +  # Add space around x-axis\n      ggplot2::scale_y_continuous(expand = ggplot2::expansion(mult = 0.2)) +  # Add space around y-axis\n\n    ggplot2::labs(\n      title = \"Paths of Zork\",\n      x = '',\n      y = '',\n      caption = \"Angle of edge determined by ggraph, not direction\"\n    )\n\n\n}\n```\n:::\n\n\n\n## playsession\n\nToday I'm impatient to get to the cellar and try out putting the `nasty knife` in the food I find in the sack and I should try talking to the troll. \n\n### get to the cellar\n\nI'll note what I haven't explored and get to the cellar.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nzork_ggraph(zork_nodes_and_edges, 'forest')\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tbl_graph: 5 nodes and 11 edges\n#\n# A directed acyclic multigraph with 2 components\n#\n# Node Data: 5 × 4 (active)\n  name           region     interactivity   loot   \n  <chr>          <chr>      <chr>           <chr>  \n1 west of house  forest     solved: mailbox leaflet\n2 north of house forest     none            none   \n3 behind house   forest     window to house none   \n4 inaccessible   unexplored none            none   \n5 unexplored     unexplored unknown         unknown\n#\n# Edge Data: 11 × 6\n   from    to perspective_location perspective_to_target target_location\n  <int> <int> <chr>                <chr>                 <chr>          \n1     1     2 west of house        north                 north of house \n2     2     3 north of house       east                  behind house   \n3     1     5 west of house        south                 unexplored     \n# ℹ 8 more rows\n# ℹ 1 more variable: discovered <dttm>\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\n*** zork regions discovered (zork_ggraph selected_region) ***\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"forest\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\n***\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nUsing \"sugiyama\" as default layout\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=1152}\n:::\n:::\n\n\n### get to the troll\n\nMake a beeline for the troll.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nzork_ggraph(zork_nodes_and_edges, 'cellar')\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tbl_graph: 12 nodes and 36 edges\n#\n# A directed multigraph with 1 component\n#\n# Node Data: 12 × 4 (active)\n   name                  region     interactivity           loot   \n   <chr>                 <chr>      <chr>                   <chr>  \n 1 cellar                cellar     none                    none   \n 2 west of chasm         cellar     unknown                 unknown\n 3 gallery               cellar     painting                none   \n 4 studio                cellar     note, 69 colours        none   \n 5 north south crawlway  cellar     hole above, no climbing unknown\n 6 the troll room        cellar     troll                   none   \n 7 maze                  cellar     unknown                 unknown\n 8 east west passageway  cellar     unknown                 unknown\n 9 ravine crossing       cellar     none                    none   \n10 circular 8 directions cellar     compass needle spins    none   \n11 inaccessible          unexplored none                    none   \n12 unexplored            unexplored unknown                 unknown\n#\n# Edge Data: 36 × 6\n   from    to perspective_location perspective_to_target target_location\n  <int> <int> <chr>                <chr>                 <chr>          \n1     1     6 cellar               east                  the troll room \n2     1     2 cellar               south                 west of chasm  \n3     1    11 cellar               west                  inaccessible   \n# ℹ 33 more rows\n# ℹ 1 more variable: discovered <dttm>\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\n*** zork regions discovered (zork_ggraph selected_region) ***\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"cellar\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\n***\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nUsing \"stress\" as default layout\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=1152}\n:::\n:::\n\n\n### overview\n\n\n::: {.cell}\n\n```{.r .cell-code}\nzork_ggraph(zork_nodes_and_edges)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tbl_graph: 18 nodes and 51 edges\n#\n# A directed multigraph with 1 component\n#\n# Node Data: 18 × 4 (active)\n   name                  region     interactivity            loot               \n   <chr>                 <chr>      <chr>                    <chr>              \n 1 west of house         forest     solved: mailbox          leaflet            \n 2 north of house        forest     none                     none               \n 3 behind house          forest     window to house          none               \n 4 kitchen               house      sack                     water, lunch, garl…\n 5 living room           house      rug, locked door to west sword, lantern     \n 6 cellar                cellar     none                     none               \n 7 west of chasm         cellar     unknown                  unknown            \n 8 gallery               cellar     painting                 none               \n 9 studio                cellar     note, 69 colours         none               \n10 north south crawlway  cellar     hole above, no climbing  unknown            \n11 the troll room        cellar     troll                    none               \n12 maze                  cellar     unknown                  unknown            \n13 east west passageway  cellar     unknown                  unknown            \n14 ravine crossing       cellar     none                     none               \n15 circular 8 directions cellar     compass needle spins     none               \n16 attic                 house      none                     rope, knife, clay  \n17 inaccessible          unexplored none                     none               \n18 unexplored            unexplored unknown                  unknown            \n#\n# Edge Data: 51 × 6\n   from    to perspective_location perspective_to_target target_location\n  <int> <int> <chr>                <chr>                 <chr>          \n1     1     2 west of house        north                 north of house \n2     2     3 north of house       east                  behind house   \n3     3     4 behind house         west                  kitchen        \n# ℹ 48 more rows\n# ℹ 1 more variable: discovered <dttm>\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\n*** zork regions discovered (zork_ggraph selected_region) ***\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"forest\" \"house\"  \"cellar\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\n***\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nUsing \"stress\" as default layout\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=1152}\n:::\n:::\n\n\n\n### lost in the maze\n\nIn this playsession, I ended up in a maze twice, so I think I've found a new region.\n\n```\n>go south\nYou are in a narrow east-west passageway.  There is a narrow staircase\nleading down at the north end of the room.\n>go down\nYou are in a deep ravine at a crossing with an east-west crawlway.\nSome stone steps are at the south of the ravine and a steep staircase\ndescends.\n>look\nYou are in a deep ravine at a crossing with an east-west crawlway.\nSome stone steps are at the south of the ravine and a steep staircase\ndescends.\n>go south\nYou are in a narrow east-west passageway.  There is a narrow staircase\nleading down at the north end of the room.\n>go east\nYou are in a circular room with passages off in eight directions.\nYour compass needle spins wildly, and you cannot get your bearings.\n>look\nYou are in a circular room with passages off in eight directions.\nYour compass needle spins wildly, and you cannot get your bearings.\n>go west\nUnfortunately, it is impossible to tell directions in here.\nYou are in a maze of twisty little passages, all alike.\n>go east\nYou are in a maze of twisty little passages, all alike.\n>go north\nYou are in a maze of twisty little passages, all alike.\n>go north\nYou are in a maze of twisty little passages, all alike.\n>go south\nYou are in a maze of twisty little passages, all alike.\n>go south\nYou are in a maze of twisty little passages, all alike.\n>go south\nYou are in a maze of twisty little passages, all alike.\n>go south\nYou are in a maze of twisty little passages, all alike.\n>go south\nYou are in a maze of twisty little passages, all alike.\n>go south\nYou are in a maze of twisty little passages, all alike.\n>go south\nYou are in a maze of twisty little passages, all alike.\n>go south\nYou are in a maze of twisty little passages, all alike.\n>go south\nYou are in a maze of twisty little passages, all alike.\n>go south\nYou are in a maze of twisty little passages, all alike.\n>go east\nYou are in a maze of twisty little passages, all alike.\n>go east\nDead end.\n>go north\nThere is a wall there.\n>go south\nYou are in a maze of twisty little passages, all alike.\n>go east\nDead end.\n>go west\nThere is a wall there.\n>go south\nYou are in a maze of twisty little passages, all alike.\n>go east\nDead end.\n>go west\nThere is a wall there.\n>go south\nYou are in a maze of twisty little passages, all alike.\n>go east\nDead end.\n>go west\nThere is a wall there.\n```\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}